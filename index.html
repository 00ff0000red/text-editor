<!DOCTYPE html>
<!--
  Copyright 2019 Google Inc.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  Author: Pete LePage (petele@google.com)
-->
<html lang="en">
  <head>
    <title>Text Editor</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- SEO description and info -->
    <meta name="description" content="Text Editor - Demo for the HTML5 Native File System.">
    <link rel="canonical" href="https://googlechromelabs.github.io/text-editor/">

    <!-- Manifest and icons -->
    <link rel="manifest" href="./manifest.json">
    <link rel="icon" type="image/png" href="./images/favicon.png">
    <meta name="theme-color" content="#1a237e">
    <link rel="apple-touch-icon" sizes="192x192" href="./images/icon-192.png">

    <!-- Add to homescreen for Chrome on Android. -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Text Edit">

    <!-- Tile icon for Windows 8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="./images/icon-144.png">
    <meta name="msapplication-TileColor" content="#1a237e">
    <meta name="msapplication-tap-highlight" content="no">

    <!-- Default twitter cards -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="https://googlechromelabs.github.io/text-editor/">
    <meta name="twitter:title" content="Text Editor">
    <meta name="twitter:description" content="Text Editor - Demo for the HTML5 Native File System.">
    <meta name="twitter:image" content="./images/icon-192.png">
    <meta name="twitter:creator" content="@petele">

    <!-- Other sharing -->
    <meta property="og:title" content="Text Editor">
    <meta property="og:type" content="website">
    <meta property="og:image" content="./images/icon-192.png">
    <meta property="og:url" content="https://googlechromelabs.github.io/text-editor/">
    <meta property="og:description" content="Text Editor - Demo for the HTML5 Native File System.">

    <!-- Analytics -->
    <script>"use strict";window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,
window.addEventListener("DOMContentLoaded",()=>{location.hostname});</script>

    <!-- import the webpage's stylesheet -->
    <style>body,html{height:100%}html{--color-900: #1a237e;--color-800: #283593;--color-700: #303f9f;--color-600: #3949ab;--color-500: #3f51b5;--color-200: #9fa8da;--color-100: #c5cae9;--color-50: #e8eaf6;--color-10: #f0f2fe;--gray-300: #e0e0e0;--gray-50: #FAFAFA;--app-header-bg: var(--color-800);--app-header-bg-highlight: var(--color-600);--app-header-color: var(--gray-50);--app-menu-color: var(--color-900);--app-menu-bg: var(--color-10);--app-menu-selected: var(--color-600);--app-menu-bg-highlight: var(--color-100);--app-menu-toggled-bg: var(--color-600);--app-menu-toggled-color: var(--color-10);--app-editor-bg: white;--app-editor-bg-disabled: var(--gray-300);--app-footer-bg: var(--app-header-bg);--app-footer-color: var(--color-100);--app-footer-color-light: var(--color-10)}body{display:flex;flex-direction:column;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";margin:0;overscroll-behavior:none;-webkit-font-smoothing:antialiased}.hidden{display:none!important}.xsmall{font-size:x-small}header{background-color:var(--app-header-bg);color:var(--app-header-color);user-select:none}header h1{font-size:x-large;margin:0;padding:4px 14px 0}button[disabled]{opacity:.5}.menuContainer{display:inline-block;position:relative}.menuContainer>button{background-color:inherit;color:inherit;min-width:48px;padding:4px 16px}body.altKey .kbdShortcut{text-decoration:underline}.menuContainer button{border:0;cursor:pointer;font-size:16px}.menuContainer button:focus{outline:0}.menuContainer .menuItemContainer{background-color:var(--app-menu-bg);box-shadow:0 8px 16px 0 rgba(0,0,0,.2);min-width:180px;position:absolute;z-index:1}.menuContainer .menuItemContainer button{background-color:var(--app-menu-bg);color:var(--app-menu-color);display:block;padding:16px;text-align:left;width:100%}.menuContainer kbd{float:right;font-family:inherit}.menuContainer>button:focus,.menuContainer>button:hover,.menuContainer>button[aria-expanded=true]{background-color:var(--app-menu-selected)}.menuItemContainer button:focus,.menuItemContainer button:hover{background-color:var(--app-menu-bg-highlight)}.menuContainer button[aria-checked=true]{background-color:var(--app-menu-toggled-bg);color:var(--app-menu-toggled-color)}header #butClose{display:none}textarea{background-color:var(--app-editor-bg);box-sizing:border-box;flex-grow:1;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";padding:2px;white-space:pre;width:100%}textarea[disabled]{background-color:var(--app-editor-bg-disabled)}textarea:focus{outline:0}body.monospace textarea{font-family:monospace}body.wordwrap textarea{white-space:normal}details{background-color:var(--app-footer-bg);color:var(--app-footer-color);padding:16px}details summary{cursor:pointer}summary>span{float:right}#tabMovesFocus{background-color:var(--color-10);border-radius:4px;color:var(--color-900);font-size:.75em;padding:4px}details #not-supported,details a,details a:visited{color:var(--app-footer-color-light)}details div{margin-top:1em}#lastUpdated{display:block;margin-top:8px}</style>
    <style>@media screen and (display-mode:standalone){header #butClose{display:block}header #butInstall,header h1{display:none}}</style>
    <style media="print">.footer,header{display:none}textarea{border:0}</style>

  </head>
  <body class="wordwrap">

    <header>
      <h1>
        <span id="headerFileName">Untitled</span><span id="modifiedHeader" class="hidden">*</span>
        - Text Editor
      </h1>
      <nav class="menubar">
        <div id="menuFile" class="menuContainer">
          <button id="butFile" class="menuTop" aria-label="File" aria-haspopup="true" aria-expanded="false">
            <span class="kbdShortcut">F</span>ile
          </button>
          <div role="menu" class="menuItemContainer hidden">
            <button id="butNew" type="button" role="menuitem">
              New <kbd>^N</kbd>
            </button>
            <button id="butOpen" type="button" role="menuitem">
              Open <kbd>^O</kbd>
            </button>
            <button id="butSave" type="button" role="menuitem">
              Save <kbd>^S</kbd>
            </button>
            <button id="butSaveAs" type="button" role="menuitem">
              Save As
            </button>
            <button id="butClose" type="button" role="menuitem">
              Close <kbd>^W</kbd>
            </button>
          </div>
        </div>
        <div id="menuEdit" class="menuContainer">
          <button id="butEdit" class="menuTop" aria-label="Edit" aria-haspopup="true" aria-expanded="false">
              <span class="kbdShortcut">E</span>dit
          </button>
          <div role="menu" class="menuItemContainer hidden">
            <button id="butCut" type="button" role="menuitem">
              Cut <kbd>^X</kbd>
            </button>
            <button id="butCopy" type="button" role="menuitem">
              Copy <kbd>^C</kbd>
            </button>
            <button id="butPaste" type="button" role="menuitem">
              Paste <kbd>^V</kbd>
            </button>
          </div>
        </div>
        <div id="menuView" class="menuContainer">
          <button id="butView" class="menuTop" aria-label="View" aria-haspopup="true" aria-expanded="false">
              <span class="kbdShortcut">V</span>iew
          </button>
          <div role="menu" class="menuItemContainer hidden">
            <button id="butWordWrap" type="button" aria-checked="true" role="menuitemcheckbox">
              Word Wrap
            </button>
            <button id="butMonospace" type="button" aria-checked="false" role="menuitemcheckbox">
              Monospace Font
            </button>
            <button id="butCaptureTabs" type="button" aria-checked="true" role="menuitemcheckbox">
              Capture Tabs <kbd>^&uparrow;M</kbd>
            </button>
            <button id="butFontBigger" type="button" role="menuitem">
              Increase Font Size
            </button>
            <button id="butFontSmaller" type="button" role="menuitem">
              Decrease Font Size
            </button>
          </div>
        </div>
        <div id="menuInstall" class="menuContainer">
          <button id="butInstall" aria-label="Install" class="menuTop hidden">
              <span class="kbdShortcut">I</span>nstall
          </button>
        </div>
      </nav>
    </header>

    <textarea id="textEditor" autofocus spellcheck="true" disabled
              aria-label="Text Editor"></textarea>

    <details id="footer" class="footer">
      <summary>About
        <span>
          <span id="modifiedFooter" class="hidden">*</span>
          <span id="tabMovesFocus" class="hidden">Tab Moves Focus</span>
        </span>
      </summary>
      <div id="not-supported">
        Sorry, the
        <a href="https://wicg.github.io/native-file-system/">Native File System API</a>
        is <b>not</b> supported in this browser yet. If you're running Chrome,
        you can try enabling the
        <code>#native-file-system-api</code> flag in
        <code>chrome://flags</code>.
      </div>
      <div>
        Text Editor is a simple text editor similar to notepad that makes
        it easy to edit text files on your local file system. It shows how
        to easily use the new HTML5 Native File System APIs. To learn more
        about the Native File System APIs and how this demo was built, check out
        <a href="https://developers.google.com/web/updates/2018/11/writable-files">
        The native file system APIs</a> article on Web Fundamentals, or see the
        <a href="https://github.com/GoogleChromeLabs/text-editor/">source
        code on GitHub</a>.
        Written by <a href="https://twitter.com/petele">Pete LePage</a>.
        <small id="lastUpdated">
          Last Updated: 2019-07-19T19:04:18.232Z (v0.0.2)
        </small>
      </div>
    </details>

    <!-- import the webpage's javascript file -->
    <script>"use strict";const app={appName:"Text Editor",fileHandle:null,isModified:!1,
editor:document.getElementById("textEditor"),fontSize:14,captureTabs:!0,isMac:navigator.userAgent.includes("Mac OS X")};</script>
    <script>"use strict";function gaEvent(n,e,t,a,o){if("localhost"===location.hostname)return;const i={eventCategory:n,
eventAction:e};t&&(i.eventLabel=t),a&&(i.eventValue=a),o&&(i.nonInteraction=!0),window.ga&&window.ga("send","event",i)}
function gaTiming(n,e,t,a){
t=parseInt(t,10),"localhost"!==location.hostname&&window.ga&&window.ga("send","timing",n,e,t,a)}
window.addEventListener("load",()=>{setTimeout(()=>{let n="browser"
;!0===window.navigator.standalone?n="standalone-ios":!0===matchMedia("(display-mode: standalone)").matches&&(n="standalone"),
gaEvent("Window Style",n,null,null,!0)},3100)}),window.addEventListener("load",()=>{if("performance"in window){
gaTiming("Start","window-load",Math.round(performance.now())),setTimeout(()=>{
const n=performance.getEntriesByType("paint");n&&n.length>0&&n.forEach(n=>{
gaTiming("Start",n.name,Math.round(n.startTime+n.duration))})},3e3)}}),window.addEventListener("DOMContentLoaded",()=>{
if("performance"in window){gaTiming("Start","dom-content-loaded",Math.round(performance.now()))}
window.ga&&window.ga("send","pageview","/")}),window.addEventListener("load",()=>{
gaEvent("App Version","0.0.2",null,null,!0)}),document.addEventListener("visibilitychange",n=>{
gaEvent("Page Visibility",!0===document.hidden?"hidden":"visible",null,null,!0)});</script>
    <script>"use strict";function setupMenu(e){const t=e.querySelector("button.menuTop");t.addEventListener("click",()=>{
_toggleMenu(t)}),addKeyboardShortcutForMenu(t),e.addEventListener("keydown",e=>{if(27===e.keyCode)return hideAllMenus(),
void setFocus();if(40!==e.keyCode)if(38!==e.keyCode);else{const t=e.srcElement.previousElementSibling;t&&t.focus()}else{
const t=e.srcElement.nextElementSibling;t&&t.focus()}})}function addKeyboardShortcutForMenu(e){if(app.isMac)return;let t
;try{t=e.querySelector(".kbdShortcut").textContent.trim().toLowerCase()}catch(e){}
t&&window.addEventListener("keydown",n=>{!0===n.altKey&&n.key===t&&e.click()})}function hideAllMenus(){
document.querySelectorAll(".menuContainer").forEach(e=>{hideMenu(e)})}function hideMenu(e){
e.querySelector(".menuTop").setAttribute("aria-expanded",!1);const t=e.querySelector(".menuItemContainer")
;t&&t.classList.toggle("hidden",!0)}function showMenu(e){
hideAllMenus(),e.querySelector(".menuTop").setAttribute("aria-expanded",!0)
;const t=e.querySelector(".menuItemContainer");t.classList.toggle("hidden",!1),t.querySelector("button").focus()}
function _toggleMenu(e){const t=e.parentElement;"true"===e.getAttribute("aria-expanded")?hideMenu(t):showMenu(t)}
app.isMac||(window.addEventListener("keydown",e=>{
!0===e.altKey&&"Alt"===e.key&&document.body.classList.toggle("altKey",!0)}),window.addEventListener("keyup",e=>{
"Alt"===e.key&&document.body.classList.toggle("altKey",!1)}));</script>
    <script>"use strict";if("chooseFileSystemEntries"in window){document.getElementById("not-supported").classList.add("hidden"),
app.editor.removeAttribute("disabled"),gaEvent("File System APIs","Supported")}else{app.noFS=!0,
document.getElementById("footer").setAttribute("open",!0),document.querySelectorAll("header button").forEach(e=>{
e.setAttribute("disabled",!0)}),gaEvent("File System APIs","Not Supported")}function newFile(){
confirmDiscard()&&(app.editor.value="",app.fileHandle=null,setFilename(),setModified(!1),setFocus(!0),
gaEvent("File Action","New"))}async function openFile(){if(confirmDiscard()){try{
const e=await getFileHandle(),t=await readFile(e);app.editor.value=t,app.fileHandle=e,setFilename(e.name),
gaEvent("File Action","Open")}catch(e){gaEvent("Error - File Action",e.name)}setModified(!1),setFocus(!0)}}
async function saveFile(){const e=app.fileHandle;try{if(!e)return await saveFileAs()
;await writeFile(e,app.editor.value),setModified(!1),gaEvent("File Action","Save")}catch(e){
gaEvent("Error - File Action",e.name)}setFocus()}async function saveFileAs(){try{const e=await getNewFileHandle()
;await writeFile(e,app.editor.value),app.fileHandle=e,setFilename(e.name),setModified(!1),
gaEvent("File Action","Save As")}catch(e){gaEvent("Error - File Action",e.name)}setFocus()}function quitApp(){
confirmDiscard()&&(gaEvent("File Action","Quit"),window.close())}</script>
    <script>"use strict";function insertIntoDoc(t){
const e=app.editor.selectionStart,n=app.editor.selectionEnd,i=app.editor.value,o=i.substring(0,e),p=i.substring(n)
;app.editor.value=o+t+p;const a=e+t.length;app.editor.selectionStart=a}function adjustFontSize(t){const e=app.fontSize+t
;e>=2&&(app.editor.style.fontSize=`${e}px`,app.fontSize=e),gaEvent("Font Size","Value",null,e)}function setFocus(t){
app.editor.focus(),t&&(app.editor.selectionStart=0,app.editor.selectionEnd=0)}app.editor.addEventListener("input",t=>{
setModified(!0)}),app.editor.addEventListener("focusin",t=>{hideAllMenus()
}),app.editor.style.fontSize=`${app.fontSize}px`,setFocus(),app.editor.addEventListener("keydown",t=>{
"Tab"===t.key&&app.captureTabs&&(t.preventDefault(),insertIntoDoc("\t"))});</script>
    <script>"use strict";function getFileHandle(){return window.chooseFileSystemEntries()}function getNewFileHandle(){
return window.chooseFileSystemEntries({type:"saveFile",accepts:[{description:"Text file",extensions:["txt"],
mimeTypes:["text/plain"]}]})}async function readFile(e){const t=await e.getFile()
;return t.text?await _readFileBlob(t):await _readFileLegacy(t)}function _readFileBlob(e){return e.text()}
function _readFileLegacy(e){return new Promise(t=>{const i=new FileReader;i.addEventListener("loadend",e=>{
const i=e.srcElement.result;t(i)}),i.readAsText(e)})}async function writeFile(e,t){const i=await e.createWriter()
;await i.truncate(0),await i.write(0,t),await i.close()}</script>
    <script>"use strict";const menuFile=document.getElementById("menuFile");setupMenu(menuFile)
;const butNewFile=document.getElementById("butNew");butNewFile.addEventListener("click",e=>{hideMenu(menuFile),newFile()
});const butOpenFile=document.getElementById("butOpen");butOpenFile.addEventListener("click",e=>{hideMenu(menuFile),
openFile()});const butSaveFile=document.getElementById("butSave");butSaveFile.addEventListener("click",e=>{
hideMenu(menuFile),saveFile()});const butSaveFileAs=document.getElementById("butSaveAs")
;butSaveFileAs.addEventListener("click",e=>{hideMenu(menuFile),saveFileAs()})
;const butCloseFile=document.getElementById("butClose");butCloseFile.addEventListener("click",e=>{hideMenu(menuFile),
quitApp()});</script>
    <script>"use strict";const menuEdit=document.getElementById("menuEdit");setupMenu(menuEdit)
;const butCut=document.getElementById("butCut");butCut.addEventListener("click",t=>{hideMenu(menuEdit),
document.execCommand("cut"),gaEvent("Edit","cut")});const butCopy=document.getElementById("butCopy")
;butCopy.addEventListener("click",t=>{hideMenu(menuEdit),document.execCommand("copy"),gaEvent("Edit","copy")})
;const butPaste=document.getElementById("butPaste");butPaste.addEventListener("click",async t=>{hideMenu(menuEdit);try{
const t=await navigator.clipboard.readText();insertIntoDoc(t),setModified(!0),setFocus(),gaEvent("Edit","paste")
}catch(t){gaEvent("Error - Paste",t.name)}});</script>
    <script>"use strict";const menuView=document.getElementById("menuView");setupMenu(menuView)
;const butWordWrap=document.getElementById("butWordWrap");butWordWrap.addEventListener("click",e=>{
const t=document.body.classList.toggle("wordwrap");butWordWrap.setAttribute("aria-checked",t),
gaEvent("Word Wrap",t?"true":"false")});const butMonospace=document.getElementById("butMonospace")
;butMonospace.addEventListener("click",e=>{const t=document.body.classList.toggle("monospace")
;butMonospace.setAttribute("aria-checked",t),hideMenu(menuView),gaEvent("Font Face",t?"monospace":"normal")})
;const butCaptureTabs=document.getElementById("butCaptureTabs");butCaptureTabs.addEventListener("click",e=>{
toggleCaptureTabs(),hideMenu(menuView)});const butFontBigger=document.getElementById("butFontBigger")
;butFontBigger.addEventListener("click",e=>{adjustFontSize(2),hideMenu(menuView),gaEvent("Font Size","Up")})
;const butFontSmaller=document.getElementById("butFontSmaller");butFontSmaller.addEventListener("click",e=>{
adjustFontSize(-2),hideMenu(menuView),gaEvent("Font Size","Down")})
;const tabMovesFocus=document.getElementById("tabMovesFocus");function toggleCaptureTabs(){const e=!app.captureTabs
;app.captureTabs=e,butCaptureTabs.setAttribute("aria-checked",e),tabMovesFocus.classList.toggle("hidden",e)}</script>
    <script>"use strict"
;const spanFileName=document.getElementById("headerFileName"),modifiedHeader=document.getElementById("modifiedHeader"),modifiedFooter=document.getElementById("modifiedFooter")
;function confirmDiscard(){if(!app.isModified)return!0;return confirm("Discard changes? All changes will be lost.")}
function setFilename(e){
e?(document.title=`${e} - ${app.appName}`,spanFileName.textContent=e):(document.title=app.appName,
spanFileName.textContent="Untitled")}function setModified(e){const t=!e;modifiedHeader.classList.toggle("hidden",t),
modifiedFooter.classList.toggle("hidden",t),app.isModified=e}window.addEventListener("beforeunload",e=>{
app.isModified&&(e.preventDefault(),e.returnValue="There are unsaved changes. Are you sure you want to leave?")});</script>
    <script>"use strict"
;window.addEventListener("keydown",e=>!0!==e.ctrlKey&&!0!==e.metaKey||"s"!==e.key?!0!==e.ctrlKey&&!0!==e.metaKey||"o"!==e.key?!0!==e.ctrlKey&&!0!==e.metaKey||"n"!==e.key?!0!==e.ctrlKey&&!0!==e.metaKey||"q"!==e.key&&"w"!==e.key?void(!0===e.ctrlKey&&!0===e.shiftKey&&"M"===e.key&&(e.preventDefault(),
e.stopPropagation(),toggleCaptureTabs())):(e.preventDefault(),void quitApp()):(e.preventDefault(),
void newFile()):(e.preventDefault(),void openFile()):(e.preventDefault(),void saveFile()));</script>
    <script>"use strict";window.addEventListener("load",()=>{
"serviceWorker"in navigator&&navigator.serviceWorker.register("./service-worker.js")});</script>
    <script>"use strict";window.addEventListener("appinstalled",t=>{gaEvent("Install","installed")})
;const butInstall=document.getElementById("butInstall");window.addEventListener("beforeinstallprompt",t=>{
t.preventDefault(),gaEvent("Install","available"),app.noFS||(app.deferredPrompt=t,
butInstall.removeAttribute("disabled"),butInstall.classList.remove("hidden"))}),
butInstall.addEventListener("click",()=>{butInstall.setAttribute("disabled",!0),app.deferredPrompt.prompt(),
gaEvent("Install","clicked")}),addKeyboardShortcutForMenu(butInstall);</script>

  </body>
</html>
